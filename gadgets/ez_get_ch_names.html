<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
    crossorigin="anonymous">
  <title>取名囉</title>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand mb-0 h1" href="#">取名囉</a>
  </nav>
  <div class="container mt-4">
    <form id="generateNames" action="#" onsubmit="generateCombination()"></form>
      <div class="form-group">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="basic-addon1">姓</span>
          </div>
          <input type="text" id="lastName" class="form-control">
        </div>
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">候選字</span>
          </div>
          <textarea form="generateNames" id="firstNameCandidates" class="form-control"></textarea>
        </div>
      </div>
      <div class="form-group">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="chbDuplicate" >
          <label class="form-check-label" for="chbDuplicate">疊字</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" id="chbSingle">
          <label class="form-check-label" for="chbSingle">單名</label>
        </div>
      </div>
      <div class="form-group">
        <button class="btn btn-primary" onclick="generateCombination()">產生</button>
      </div>
    </form>
    <ul class="list-group list-group-flush" id="results">

    </ul>
  </div>

  <script>
    function generateCombination() {
      let lastName = document.querySelector('#lastName').value;
      let candidates = document.querySelector('#firstNameCandidates').value.replace(/\r?\n|\r/g, "").split("");
      let needDuplicate = document.querySelector('#chbDuplicate').checked;
      let needSingle = document.querySelector('#chbSingle').checked;

      clearResults();
      if (needSingle === true) {
        candidates.forEach(word => appendNameToResult(lastName + word) );
      }
      if (needDuplicate === true) {
        candidates.forEach(word => appendNameToResult(lastName + word + word));
      }

      for (let i = 0; i < candidates.length; i++ ) {
        for (let j = 0; j < candidates.length; j++) {
          if (i === j) { continue; }
          appendNameToResult(lastName + candidates[i] + candidates[j]);
        }
      }
    }

    function appendNameToResult(name) {
      let resultsList = document.querySelector('#results');
      let node = document.createElement("li");

      if (resultsList.childNodes.length % 2 == 0) {
        node.className = "list-group-item list-group-item-primary";
      } else {
        node.className = "list-group-item list-group-item-secondary";
      }

      let textNode = document.createTextNode(name);
      node.appendChild(textNode);
      resultsList.appendChild(node);
    }

    function clearResults() {
      let resultsNode = document.querySelector('#results');
      while (resultsNode.firstChild) {
        resultsNode.removeChild(resultsNode.firstChild);
      }
    }
  </script>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
</body>
</html>